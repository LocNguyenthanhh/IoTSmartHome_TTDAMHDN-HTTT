<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Home - Homepage</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e3f2fd 100%);
            min-height: 100vh;
            transition: all 0.3s;
        }

        body.dark-mode {
            background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
        }

        body.dark-mode .header,
        body.dark-mode .temp-card,
        body.dark-mode .stat-card,
        body.dark-mode .feature-card,
        body.dark-mode .device-item {
            background: #1f2937;
            box-shadow: 0 1px 3px rgba(255, 255, 255, 0.1);
        }

        body.dark-mode .temp-card {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
        }

        body.dark-mode .user-text h3,
        body.dark-mode .temp-location,
        body.dark-mode .temp-value h1,
        body.dark-mode .temp-status,
        body.dark-mode .temp-details div p:last-child,
        body.dark-mode .stat-card h2,
        body.dark-mode .section-header h2,
        body.dark-mode .feature-card h3,
        body.dark-mode .device-text h4 {
            color: #f3f4f6;
        }

        body.dark-mode .user-text p,
        body.dark-mode .temp-details div p:first-child,
        body.dark-mode .stat-card p,
        body.dark-mode .feature-card p,
        body.dark-mode .device-text p {
            color: #9ca3af;
        }

        body.dark-mode .see-all {
            color: #60a5fa;
        }

        body.dark-mode .stat-icon.green { background: #166534; }
        body.dark-mode .stat-icon.blue { background: #1e40af; }
        body.dark-mode .stat-icon.purple { background: #6b21a8; }

        body.dark-mode .feature-icon.blue { background: linear-gradient(135deg, #1e40af 0%, #1e3a8a 100%); }
        body.dark-mode .feature-icon.green { background: linear-gradient(135deg, #166534 0%, #14532d 100%); }
        body.dark-mode .feature-icon.purple { background: linear-gradient(135deg, #6b21a8 0%, #5b21b6 100%); }
        body.dark-mode .feature-icon.orange { background: linear-gradient(135deg, #9a3412 0%, #7c2d12 100%); }

        body.dark-mode .device-icon.yellow { background: #92400e; }
        body.dark-mode .device-icon.blue { background: #1e40af; }

        body.dark-mode .toggle-switch.off {
            background: #4b5563;
        }

        .container {
            max-width: 480px;
            margin: 0 auto;
            background: transparent;
        }

        /* Header */
        .header {
            background: white;
            padding: 16px 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: all 0.2s;
            padding: 4px;
            border-radius: 12px;
        }

        .user-info:hover {
            background: #f3f4f6;
        }

        .user-info:active {
            transform: scale(0.98);
        }

        .avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .user-text h3 {
            font-size: 14px;
            font-weight: 600;
            color: #1f2937;
        }

        .user-text p {
            font-size: 12px;
            color: #6b7280;
        }

        .header-actions {
            display: flex;
            gap: 8px;
        }

        /* Main Content */
        .content {
            padding: 24px;
        }

        /* Temperature Card */
        .temp-card {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            border-radius: 24px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.3);
        }

        .temp-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .temp-location {
            display: flex;
            align-items: center;
            gap: 8px;
            color: rgba(255,255,255,0.8);
            font-size: 14px;
        }

        .temp-value {
            display: flex;
            align-items: flex-end;
            gap: 8px;
            margin-bottom: 16px;
        }

        .temp-value h1 {
            font-size: 48px;
            font-weight: 700;
            color: white;
        }

        .temp-status {
            color: rgba(255,255,255,0.8);
            margin-bottom: 8px;
        }

        .temp-details {
            display: flex;
            gap: 24px;
            color: rgba(255,255,255,0.8);
            font-size: 14px;
        }

        .temp-details div p:first-child {
            opacity: 0.8;
            margin-bottom: 4px;
        }

        .temp-details div p:last-child {
            font-weight: 600;
            color: white;
        }

        /* Quick Stats */
        .quick-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 16px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 12px;
        }

        .stat-icon.green { background: #dcfce7; color: #16a34a; }
        .stat-icon.blue { background: #dbeafe; color: #2563eb; }
        .stat-icon.purple { background: #f3e8ff; color: #9333ea; }

        .stat-card h2 {
            font-size: 24px;
            font-weight: 700;
            color: #1f2937;
        }

        .stat-card p {
            font-size: 12px;
            color: #6b7280;
        }

        /* Features */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .section-header h2 {
            font-size: 18px;
            font-weight: 700;
            color: #1f2937;
        }

        .see-all {
            color: #3b82f6;
            font-size: 14px;
            font-weight: 500;
            text-decoration: none;
            cursor: pointer;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .feature-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
            text-decoration: none;
            color: inherit;
            display: block;
        }

        .feature-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transform: translateY(-2px);
        }

        .feature-card:active {
            transform: scale(0.98);
        }

        .feature-icon {
            width: 56px;
            height: 56px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 12px;
        }

        .feature-icon.blue { background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); color: #2563eb; }
        .feature-icon.green { background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%); color: #16a34a; }
        .feature-icon.purple { background: linear-gradient(135deg, #f3e8ff 0%, #e9d5ff 100%); color: #9333ea; }
        .feature-icon.orange { background: linear-gradient(135deg, #fed7aa 0%, #fdba74 100%); color: #ea580c; }

        .feature-card h3 {
            font-size: 16px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 4px;
        }

        .feature-card p {
            font-size: 12px;
            color: #6b7280;
        }

        /* Quick Access */
        .device-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 24px;
        }

        .device-item {
            background: white;
            border-radius: 16px;
            padding: 16px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .device-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .device-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .device-icon.yellow { background: #fef3c7; color: #d97706; }
        .device-icon.blue { background: #dbeafe; color: #2563eb; }

        .device-text h4 {
            font-size: 14px;
            font-weight: 600;
            color: #1f2937;
        }

        .device-text p {
            font-size: 12px;
            color: #6b7280;
        }

        /* Toggle Switch */
        .toggle-switch {
            width: 48px;
            height: 28px;
            background: #22c55e;
            border-radius: 14px;
            position: relative;
            cursor: pointer;
            transition: background 0.3s;
        }

        .toggle-switch.off {
            background: #e5e7eb;
        }

        .toggle-knob {
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            position: absolute;
            top: 4px;
            right: 4px;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .toggle-switch.off .toggle-knob {
            right: 24px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="user-info" onclick="goToSettings()">
                <div class="avatar">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                </div>
                <div class="user-text">
                    <p>Welcome</p>
                    <h3>User Name</h3>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="content">
            <!-- LIGHT Card -->
            <div class="temp-card">
                <div class="temp-header">
                    <div class="temp-location">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                            <polyline points="9 22 9 12 15 12 15 22"></polyline>
                        </svg>
                        <span>Your home</span>
                    </div>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="rgba(255,255,255,0.8)" stroke-width="2">
                        <path d="M12 12c-3.314 0-6-2.686-6-6s2.686-6 6-6 6 2.686 6 6-2.686 6-6 6zM2 12h2M20 12h2M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M4.93 19.07l1.41-1.41M17.66 6.34l1.41-1.41"></path>
                    </svg>
                </div>
                <div class="temp-value">
                    <h1 id="current-sensor-value">32<span style="font-size: 0.5em;">%</span></h1> 
                    <span class="temp-status" id="sensor-status-text">Comfortable</span>
                </div>
                
                </div>
            <!-- Quick Stats -->
            <div class="quick-stats">
                <div class="stat-card">
                    <div class="stat-icon green">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18.36 6.64a9 9 0 1 1-12.73 0"></path>
                            <line x1="12" y1="2" x2="12" y2="12"></line>
                        </svg>
                    </div>
                    <h2>5</h2>
                    <p>Active</p>
                </div>
                <div class="stat-card">
                    <div class="stat-icon blue">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                    </div>
                    <h2>3</h2>
                    <p>Schedules</p>
                </div>
                <div class="stat-card">
                    <div class="stat-icon purple">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                        </svg>
                    </div>
                    <h2>23%</h2>
                    <p>Saved</p>
                </div>
            </div>

            <!-- Features -->
            <div class="section-header">
                <h2>Features</h2>
            </div>
            <div class="features-grid">
               <a href="/devicescontrol" class="feature-card">
    <div class="feature-icon blue">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
        </svg>
    </div>
    <h3>Devices</h3>
    <p>Control your devices</p>
</a>

<a href="/schedules" class="feature-card">
    <div class="feature-icon green">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
            <line x1="16" y1="2" x2="16" y2="6"></line>
            <line x1="8" y1="2" x2="8" y2="6"></line>
            <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
    </div>
    <h3>Schedules</h3>
    <p>Manage automation</p>
</a>

<a href="/history" class="feature-card">
    <div class="feature-icon purple">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
    </div>
    <h3>History</h3>
    <p>View activity logs</p>
</a>

<a href="/analytics" class="feature-card">
    <div class="feature-icon orange">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="20" x2="12" y2="10"></line>
            <line x1="18" y1="20" x2="18" y2="4"></line>
            <line x1="6" y1="20" x2="6" y2="16"></line>
        </svg>
    </div>
    <h3>Analytics</h3>
    <p>Energy insights</p>
</a>
            </div>

       
            
        </div>
    </div>

    <script>
        // Load user data from localStorage
        function loadUserData() {
            const stored = localStorage.getItem('userData');
            if (stored) {
                try {
                    const userData = JSON.parse(stored);
                    if (userData.settings.darkMode) {
                        document.body.classList.add('dark-mode');
                    }
                    document.querySelector('.user-text h3').textContent = userData.name || 'User Name';
                } catch (error) {
                    console.error('Error loading user data:', error);
                }
            }
        }

        // Toggle device switch
        function toggleDevice(element) {
            element.classList.toggle('off');
        }

        // Go to account page when clicking user info
        function goToSettings() {
            window.location.href = '/account';
        }

        

        // Initialize
        window.addEventListener('load', () => {
            loadUserData();
        });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script>
        var socket = io.connect('http://127.0.0.1:5000');
        
        socket.on('homepage_sensor_update', function(data) {
            const value = parseFloat(data.value).toFixed(1); // Lấy giá trị và làm tròn
            const statusElement = document.getElementById('sensor-status-text');
            const valueElement = document.getElementById('current-sensor-value');
            
            // Cập nhật giá trị hiển thị với đơn vị % nhỏ hơn
            valueElement.innerHTML = `${value}<span style="font-size: 0.5em;">%</span>`;

            // Cập nhật trạng thái chữ đi kèm
            let statusText = 'Bình thường';
            if (value > 80) {
                statusText = 'Quá Sáng';
            } else if (value < 20) {
                statusText = 'Quá Tối';
            }
            statusElement.textContent = statusText;
        });
    </script>
</body>
</html>